<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <title>Searchbox inspection suite</title>

  <!-- SCRIPTS -->
  <script type="text/javascript" src="../node_modules/jquery/dist/jquery.js"></script>
  <script type="text/javascript" src="../node_modules/underscore/underscore.js"></script>
  <script type="text/javascript" src="../lib/build/combo.js"></script>
  <script type="text/javascript" src="feature_description.js"></script>

  <!-- coffee -co examples combojs.coffee -->
  <script type="text/javascript" src="../lib/coffee-script.js"></script>
  <script type="text/coffeescript">

    uuid = ->
      'xxxxxxxx xxxx 4xxx yxxx xxxxxxxxxxxx'.replace(/[xy]/g, (c) ->
        r = Math.random() * 16 | 0
        v = if c is 'x' then r else (r & 0x3|0x8)
        v.toString(16)
    )

    render_test = (id, msg, data) ->
      $("<div id='#{id}'>")
        .append("<h3>#{msg}</h3>")
        .append("<div id='inner-#{id}'></div>")
        .append('<br />')
        .appendTo('body')

      combo = new Combo()
      combo.load(data)
      combo.appendTo("#inner-#{id}")
      combo.renderFullList()

    openListMaybe = (selector) ->
      setTimeout (() -> $("#{selector} .combo-button").click()), 0

    # TODO: dry
    _data_1275 = (
      {
        id: i
        text: if i < 8 then ("my special number is 0.62" + i) else uuid()
        true: i%2
      } for i in [0...1271])
    _data_1275.push({
      id: 1272
      text: "Massiv væg mod uopvarmet rum, 12 cm tegl, 250 mm udvendig isolering.  (U: 0.14)"
      true: true
    })
    _data_1275.push({
      id: 127,
      text: "Massiv ydervæg, 12 cm tegl, 250 mm udvendig isolering.  (U: 0.14)"
      true: true
    })
    _data_1275.push({
      id: 1271
      text: "Massiv ydervæg, Bindingsværk, 100 mm..  (U: 0.34)"
      true: true
    })
    _data_1275.push({
      id: 1272
      text: "Massiv ydervæg, Bindingsværk, 100 mm..  (U: 0.34)"
      true: true
    })

    data_10000 = (
      {
        id: i
        text: "hello world, we are legion and my name is mister #{i} and this is my loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooong string"
        true: true
      } for i in [0...10000])

    $ ->
      if data_10000.length isnt 10000
        throw Error("wrong test data! " + data_10000.length)
      if _data_1275.length isnt 1275
        throw Error("wrong test data! " + _data_1275.length)

      render_test('empty-list', "Combojs with empty list", [])
      render_test('medium-list', "Combojs with half enabled list", _data_1275)
      render_test('large-list', "Combojs with 10000 elements", data_10000)

      $('body').append("<div id='features'><pre>#{_feature_description}</pre></div>")
  </script>
  <link rel="stylesheet" href="../lib/build/combo.css" />
  <style>
    #features {
      position: absolute;
      left: 1200px;
      top: 0px;
    }
  </style>
</head>
<body></body>
</html>
